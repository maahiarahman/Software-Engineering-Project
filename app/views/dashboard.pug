extends layout

block content
  h2 Recipe Dashboard

  // Welcome Modal (Popup)
  if userName
    #welcomeModal.fixed.inset-0.bg-black.bg-opacity-50.flex.items-center.justify-center.z-50(style="display: flex;")  // Display modal by default
      .bg-white.rounded-xl.shadow-lg.p-8.max-w-md.text-center
        h2.text-2xl.font-bold.text-green-700.mb-2 Welcome, #{userName}!
        p.mb-4 Glad to have you back on Recipe Swap.
        button#welcomeCloseBtn.mt-2.px-4.py-2.bg-green-600.text-white.rounded.hover.bg-green-700 Let's Go!


  // Search
  #usersearchcontainer
    input(
      type="search" 
      id="usersearch" 
      onkeyup="searchFunction()" 
      placeholder="Search for a recipe here"
    )
    ul#searchcontainer
      each recipe in recipes
        .searchresults
          a(href=`/recipes/${recipe.recipe_id}`) #{recipe.name}

  // Recipe Grid
  if recipes && recipes.length
    .recipe-grid
      each recipe in recipes
        .recipe-card
          a(href=`/recipes/${recipe.recipe_id}`)
            img(src=recipe.image_url, alt=recipe.name)
            h3= recipe.name
            p= recipe.description
            p
              a(href=`/profile/${recipe.user_id}`) Recipe by #{recipe.first_name}
            
  else
    p No recipes found.

  // Link to profile
  a(href=`/profile/${user.user_ID}`) View Profile

  // Reviews Section
  h2 User Reviews
  .review-section
    if reviews && reviews.length
      each review in reviews
        .review-card
          img(src="/profile%20image.jpg" alt="User Profile")
          .review-content
            h4= review.name
            p= review.text
    else
      p No reviews available.

  // Dessert Container
  #dessertcontainer
    p Try to recreate me!
    #imageContainer
      img(src="" alt="Dessert Image")
    p NO HINTS!

  // Modal Script
  script.
    document.addEventListener('DOMContentLoaded', function () {
      const modal = document.getElementById('welcomeModal');
      const closeBtn = document.getElementById('welcomeCloseBtn');

      // Open the modal (check if it's not open already)
      if (modal) {
        modal.style.display = 'flex'; // Display the modal
      }

      // Add event listener to close the modal when the "Let's Go!" button is clicked
      if (closeBtn) {
        closeBtn.addEventListener('click', function () {
          modal.style.display = 'none';  // Close the modal
        });
      }
    });
