doctype html
html(lang="en")
  head
    title Nom Nom â€” Recipe Swap
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css")
    link(rel="preconnect", href="https://fonts.googleapis.com")
    link(rel="preconnect", href="https://fonts.gstatic.com" crossorigin)
    link(href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet")

    // Stylesheets
    link(rel="stylesheet", href="/css/style.css")
    if !isAdminPage
      link(rel="stylesheet", href="/css/dark-mode.css")

  body(class=isAdminPage ? 'admin' : '')
    nav.navbar
      .navbar-content.container
        a.navbar-brand(href="/")
          span.logo-text Nom<span class="highlight">Nom</span>
        .nav-links
          a(href="/splash") Home
          a(href="/about") About
          a(href="/contact") Contact
          a(href="/swap") Swap
          if !user
            a(href="/login") Login
            a(href="/register") Register
          else
            a(href="/dashboard") Dashboard
            a(href=`/profile/${user.id || user.user_ID}`) Profile
            a(href="/logout") Logout
        if user && user.badge
          span.user-badge(class=user.badge.toLowerCase())
            i(class="fa-solid fa-medal")
            |  #{user.badge.toUpperCase()} MEMBER

    // ðŸŒ— Dark mode toggle
    button.dark(title="Toggle Dark Mode")
      i.fa-solid.fa-lightbulb

    main.container.mt-4
      block content

    footer.site-footer
      .footer-container
        p Â© #{year} Nom Nom. All rights reserved.
        p
          a(href="/terms") Terms & Conditions

    // Scripts
    script(src="/js/search.js")
    script(src="/js/script.js")
    script(src="/js/dark-mode.js")
    script(src="/js/reviews.js")
    script(src="/js/recipe.js")
    script(src="/js/swap.js")
    script(src="/js/api.js")

    block scripts
      script.
        const modal = document.getElementById('swap-modal');
        const recipeName = document.getElementById('modal-recipe-name');
        const recipeIdField = document.getElementById('targetRecipeId');
        const userIdField = document.getElementById('targetUserId');

        function closeModal() {
          modal.classList.add('hidden');
        }

        document.querySelectorAll('.swap-button').forEach(button => {
          button.addEventListener('click', () => {
            modal.classList.remove('hidden');
            recipeName.textContent = `Youâ€™re requesting a swap for: ${button.dataset.name}`;
            recipeIdField.value = button.dataset.id;
            userIdField.value = button.dataset.user;
          });
        });

        modal.addEventListener('click', e => {
          if (e.target === modal) closeModal();
        });
