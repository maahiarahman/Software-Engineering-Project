extends adminlayout

block content
  .max-w-6xl.mx-auto.p-6.bg-white.shadow-lg.rounded-xl
    h1.text-3xl.font-bold.text-green-800.mb-6.text-center User Profile Overview

    // üë§ USER INFO
    .grid.grid-cols-1.md:grid-cols-2.gap-6.mb-10
      .flex.flex-col.gap-2
        h2.text-xl.font-semibold.text-green-700 User Details
        p.font-medium Name: #{user.first_name} #{user.last_name}
        p Email: #{user.email}
        p Age: #{user.age}
        p DOB: #{user.date_of_birth}
        p User ID: #{user.user_ID}
        if !user.isBanned
          form(action=`/user/${user.user_ID}/ban`, method="POST")
            button.bg-yellow-500.text-white.px-4.py-2.rounded.hover\:bg-yellow-600(type="submit" onclick="return confirm('Ban this user?')") Ban User
        else
          p.text-red-500.font-bold This user is banned.
        form(action=`/user/${user.user_ID}/delete`, method="POST")
          button.bg-red-600.text-white.px-4.py-2.rounded.hover\:bg-red-700(type="submit" onclick="return confirm('Delete this user permanently?')") Delete User

      .flex.flex-col.gap-4
        h2.text-xl.font-semibold.text-green-700.text-center Account Status
        ul.list-disc.list-inside.text-gray-700
          li Account active: #{!user.isBanned ? 'Yes' : 'No'}
          li Recipes uploaded: #{recipes?.length || 0}
          li Reviews written: #{reviews?.length || 0}
          li Posts made: #{posts?.length || 0}

    // üçΩÔ∏è RECIPE CONTRIBUTIONS
    if recipes && recipes.length
      h3.text-green-800.mt-10.mb-4.text-xl.font-bold.text-center User Recipes
      .grid.grid-cols-1.md:grid-cols-2.lg:grid-cols-3.gap-4
        each recipe in recipes
          .bg-gray-100.p-4.rounded-lg.shadow
            h4.text-lg.font-semibold.text-green-700.mb-1= recipe.name
            p.text-gray-600.mb-2= recipe.description
            form(action=`/user/${user.user_ID}/recipes/${recipe.recipe_id}/delete`, method="POST")
              button.bg-red-500.text-white.px-3.py-1.rounded.hover\:bg-red-600(type="submit" onclick="return confirm('Delete this recipe?')") Delete Recipe
    else
      p.text-center.text-gray-500.mt-6 No recipes found.

    // ‚≠ê USER REVIEWS
    if reviews && reviews.length
      h3.text-green-800.mt-10.mb-4.text-xl.font-bold.text-center Reviews by User
      .space-y-4
        each review in reviews
          .bg-white.border.border-gray-200.p-4.rounded.shadow
            p.text-gray-800.mb-2= review.comment
            p.text-sm.text-green-700.font-semibold Rating: #{review.rating} ‚≠ê
            p.text-xs.text-gray-500= `Posted on ${review.created_at}`
            form(action=`/user/${user.user_ID}/review/${review.review_ID}/delete`, method="POST")
              button.bg-red-500.text-white.px-3.py-1.rounded.hover\:bg-red-600(type="submit" onclick="return confirm('Delete this review?')") Delete Review
    else
      p.text-center.text-gray-500.mt-6 No reviews found.

    // üìù POSTS MADE
    if posts && posts.length
      h3.text-green-800.mt-10.mb-4.text-xl.font-bold.text-center User Posts
      table.w-full.border.text-sm
        thead.bg-green-200
          tr
            th.px-3.py-2 Post ID
            th.px-3.py-2 User ID
            th.px-3.py-2 Recipe ID
            th.px-3.py-2 Date Posted
        tbody
          each post in posts
            tr.border-b
              td.px-3.py-2= post.post_ID
              td.px-3.py-2= post.user_ID
              td.px-3.py-2= post.recipe_ID
              td.px-3.py-2= post.date_posted
    else
      p.text-center.text-gray-500.mt-6 No posts found.

    // üîÅ INCOMING SWAP REQUESTS
    if swaps && swaps.length
      h3.text-green-800.mt-10.mb-4.text-xl.font-bold.text-center Incoming Swap Requests
      .space-y-4
        each swap in swaps
          .bg-yellow-50.border.border-yellow-300.p-4.rounded.shadow
            p.text-sm.text-gray-800.font-medium Recipe requested: #{swap.recipe_name}
            p.text-xs.text-gray-500 Sent by user ID: #{swap.requester_id}
            p.text-xs.text-gray-500 Date: #{swap.created_at}
            .flex.gap-3.mt-2
              button.bg-green-600.text-white.px-3.py-1.rounded.hover\:bg-green-700 Accept
              button.bg-red-500.text-white.px-3.py-1.rounded.hover\:bg-red-600 Reject
    else
      p.text-center.text-gray-500.mt-6 No incoming swap requests.

    // üìç Footer / Status Bar
    .mt-12.text-center.text-xs.text-gray-400.border-t.pt-4
      p Nom Nom Admin Panel | Profile Summary | Updated #{new Date().toLocaleDateString()}

block scripts
  script(src="/js/profile.js")
